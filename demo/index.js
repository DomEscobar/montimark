!function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){t.exports=e(2)},function(t,n,e){},function(t,n,e){"use strict";e.r(n);e(1);function r(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var o=function(){function t(n,e){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"configurations",{rect:{w:null,h:null},position:{x:10,y:10}}),i(this,"orginals",[]);var a=document.querySelectorAll(n);o&&this.handleParams(o),this.showOriginals=this.showOriginals.bind(this),this.markImages=this.markImages.bind(this),this.watermark=this.watermark.bind(this),this.loadImage(e).then(function(t){r.markImages(a,t)}),document.monetization&&document.monetization.addEventListener("monetizationstart",function(){r.showOriginals(a)})}var n,e,o;return n=t,(e=[{key:"showOriginals",value:function(t){var n=this;t.forEach(function(t){var e=n.orginals.find(function(n){return n.id===t.getAttribute("markId")});e&&(t.src=e.src)})}},{key:"markImages",value:function(t,n){var e=this,r=this;t.forEach(function(t){if(t instanceof HTMLImageElement){var i=e.randomUid();t.crossOrigin="*",r.orginals.push({id:i,src:t.src});var o=e.drawImage(t);o=e.watermark(o,n),t.src=e.dataUrl(o),t.setAttribute("markId",i)}})}},{key:"loadImage",value:function(t){var n=new Image;return n.crossOrigin="*",new Promise(function(e){n.onload=function(){return e(n)},n.src=t})}},{key:"drawImage",value:function(t){var n=document.createElement("canvas"),e=n.getContext("2d");return n.width=t.width,n.height=t.height,e.drawImage(t,0,0,t.width,t.height),n}},{key:"watermark",value:function(t,n){return t.getContext("2d").drawImage(n,this.configurations.position.x,this.configurations.position.y,this.configurations.rect.w||n.width,this.configurations.rect.h||n.height),t}},{key:"dataUrl",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:"image/png",encoderOptions:.92};return t.toDataURL(n.type,n.encoderOptions)}},{key:"randomUid",value:function(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}},{key:"handleParams",value:function(t){this.configurations.rect=t.rect||this.configurations.rect,this.configurations.position=t.position||this.configurations.position}}])&&r(n.prototype,e),o&&r(n,o),t}();new function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),new o(".test","watermark.png",{rect:{w:100,h:100},position:{x:20,y:50}})}}]);
//# sourceMappingURL=index.js.map